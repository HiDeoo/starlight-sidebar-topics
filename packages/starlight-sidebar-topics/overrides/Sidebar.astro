---
import Default from '@astrojs/starlight/components/Sidebar.astro'
import type { Props } from '@astrojs/starlight/props'
import config from 'virtual:starlight-sidebar-topics-config'

import { getCurrentTopic } from '../libs/sidebar'

const { entry, sidebar } = Astro.props

let currentSidebar = sidebar
const currentTopic = getCurrentTopic(config, sidebar)

if (entry['data'].template !== 'splash') {
  // TODO(HiDeoo)
  if (!currentTopic) throw new Error('No current sidebar topic found')
  currentSidebar = currentTopic.sidebar
}

// FIXME(HiDeoo)
console.error('ðŸš¨ [Sidebar.astro:15] currentTopic:', currentTopic)
---

<Default {...Astro.props} sidebar={currentSidebar}><slot /></Default>
