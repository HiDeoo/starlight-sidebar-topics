---
import { getRelativeLocaleUrl } from 'astro:i18n'
import config from 'virtual:starlight-sidebar-topics-config'

import type { StarlightSidebarTopicsSharedConfig } from '../libs/config'

interface Props {
  current: StarlightSidebarTopicsSharedConfig[number]
}

const { current } = Astro.props
---

<ul>
  {
    config.map((topic) => {
      const isLinkTopic = topic.type === 'link'
      const isCurrent = isLinkTopic ? false : topic.label === current.label && topic.link === current.link
      const link =
        !isLinkTopic && Astro.currentLocale ? getRelativeLocaleUrl(Astro.currentLocale, topic.link) : topic.link

      return (
        <li>
          <a href={link}>
            {isCurrent ? '[x] - ' : '[ ] - '}
            {topic.label}
          </a>
        </li>
      )
    })
  }
</ul>
